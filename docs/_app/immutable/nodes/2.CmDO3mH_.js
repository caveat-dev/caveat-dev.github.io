import{s as ie,n as X,r as oe,o as ae,e as J}from"../chunks/scheduler.CtbWrGNo.js";import{S as ue,i as ce,e as S,s as R,t as Y,c as L,f as D,z as G,a as j,d as w,b as $,p,q as K,g as k,h as A,A as ee,B as Z,j as fe}from"../chunks/index.DX2qvOTm.js";let C=new Map([["COLORS",new Map([["text","#cdd6f4"],["error","#f38ba8"],["warning","#f9e2af"],["success","#a6e3a1"],["heading","#cba6f7"],["link","#89b4fa"],["command","#f5e0dc"]])]]);function te(e){let n=C.get(e);if(!n)return"";let t="";return n.forEach((r,o)=>{e==="COLORS"?t+=`${o}: {${r}}
`:t+=`${o}: ${r}
`}),t.substring(0,t.length-1)}function O(e){let n=C.get("COLORS"),t=new RegExp(String.raw`(?<!\\)[a-zA-Z0-9 ]*(?<!https|http):`,"g");return Array.from(e.matchAll(t),r=>{e=e.replaceAll(r[0],`<span style='color: ${n.get("heading")}'>${r[0].substring(0,r[0].length)}</span>`)}),g.forEach(r=>{let o=new RegExp(String.raw`\[${r.aliases}\]`,"g");e=e.replaceAll(o,`<span style='color: ${n.get("command")}'>${he(r)}</span>`)}),t=new RegExp(String.raw`(https)://\S*`,"g"),Array.from(e.matchAll(t),r=>{e=e.replaceAll(r[0],`<span style='color: ${n.get("link")}'>${r[0]}</span>`)}),t=new RegExp(String.raw`\{#[a-fA-F0-9]{6}\}`,"g"),Array.from(e.matchAll(t),r=>{let o=r[0].substring(1,r[0].length-1);e=e.replaceAll(r[0],`<span style='color: ${o}'>${o}</span>`)}),e=e.replaceAll(/\n|\\n/g,"<br>"),e=e+"<br>",`<span style="word-break: normal; hyphens: auto">${e}</span>`}function he(e){return`[${e.aliases.toString().replaceAll(",",", ")}]`}function ge(){localStorage.clear(),localStorage.setItem("wd","/home/anon"),localStorage.setItem("fs",JSON.stringify({name:"/",contents:[{name:"home",contents:[{name:"anon",contents:[]}]},{name:"bin",contents:[]}]}))}function le(){return JSON.parse(localStorage.getItem("fs"))}function V(){return localStorage.getItem("wd")}function ne(e){let n=le().contents,t=!0;e.startsWith("/")||(e=`${V()}/${e}`),e.endsWith("/")&&(e=e.substring(0,e.length-1));let r=e.split("/"),o=!0;for(;o;){o=!1;for(let l=0;l<r.length;l++)r[l]===".."&&(r.splice(l-1,2),o=!0)}if(r.length<=1&&(r=[]),console.log(r),r.forEach(l=>{if(l!==""){let s=!1;if(n.forEach(a=>{if(typeof a.contents!="string"&&a.name===l){n=a.contents,s=!0;return}}),!s){t=!1;return}}}),t){let l="";return n.forEach(s=>{l+=`${s.name}`,typeof s.contents!="string"&&(l+="*"),l+=" "}),l=l.trim()+`
`,l.trim()===""&&(l=""),l}else return e=e.replaceAll("//","/"),`<span style="color: ${C.get("COLORS").get("error")}">Error:</span> invalid path '${e}'
`}function U(e){localStorage.setItem("wd",e)}function re(e){if(e==="/")return U("/"),!0;if(e==="")return U("/home/anon"),!0;if(e.startsWith("/")){if(e=e.substring(1),e==="")return U("/"),!0}else e=`${V()}/${e}`,e.endsWith("/")&&(e=e.substring(0,e.length-1));let n="/";const t=e.split("/");let r=le().contents,o=!0;for(;o;){o=!1;for(let s=0;s<t.length;s++)t[s]===".."&&(t.splice(s-1,2),o=!0)}if(t.length<=1)return U("/"),!0;let l=!1;return t.forEach(s=>{if(l=!1,r.forEach(a=>{if(typeof a.contents!="string"&&a.name===s){r=a.contents,n+=`${a.name}/`,l=!0;return}}),!l){l=!1;return}}),n=n.substring(0,n.length-1),l&&U(n),l}const W="&lt;",z="&gt;";function pe(e,n,t,r){return{aliases:e,description:n,usage:t,callback:r}}function b(e,n,t,r){return[e[0],pe(e,n,t,r)]}const g=new Map([b(["welcome"],"Prints the welcome message.","welcome",e=>{if(e.length!==0)return v(g.get("welcome"));const n=`Welcome to CAVM 1.0.0.
Type [${g.get("help").aliases}] for a list of commands.`;return{result:!0,text:O(n),historyChanged:!1,newHistory:null}}),b(["help","h"],"Prints available commands.",`help, help ${W}#page${z}`,e=>{let n=1;if(e.length>1)return v(g.get("help"));if(e.length!=0){if(n=Number.parseInt(e[0]),isNaN(n))return v(g.get("help"));n=Math.max(1,n),n=Math.min(Math.ceil(g.size/3),n)}const t=n*3-3,r=Math.min(t+2,g.size-1);let o="";const l=Array.from(g);for(let s=t;s<=r;s++)o+=`[${l[s][1].aliases}]
Description: ${l[s][1].description}
Usage: ${l[s][1].usage}
`;return o+=`Page ${n}/${Math.ceil(g.size/3)}`,{result:!0,text:O(o),historyChanged:!1,newHistory:null}}),b(["clear","cls"],"Clears the screen.","cls",e=>e.length!==0?v(g.get("clear")):{result:!0,text:null,historyChanged:!0,newHistory:""}),b(["accounts"],"Prints Caveat's git pages, socials, and other accounts online.","accounts",e=>e.length!==0?v(g.get("accounts")):{result:!0,text:O(`Email: cv@caveat.cc
Discord: caveat__
Git Accounts:
https://codeberg.org/caveat (preferred)
https://github.com/caveat-dev`),historyChanged:!1,newHistory:null}),b(["bio"],"Prints Caveat's bio.","bio",e=>e.length!==0?v(g.get("bio")):{result:!0,text:O(`Caveat (often stylized as caveat, full name Caveat Emptor) is an amateur developer and FOSS enthusiast from North America.
They enjoy developing programs in Rust and Haskell, but begrudgingly use Javascript the most.
Watch them develop open-source software that nobody uses!`),historyChanged:!1,newHistory:null}),b(["echo"],"Prints the given text and/or environment variables.",`echo ${W}text${z}`,e=>{let n="";return e.forEach(t=>{t.startsWith("$")?(n=n.substring(0,n.length-1),n+=`${te(t.substring(1,t.length))} `):n+=`${t} `}),{result:!0,text:O(n),historyChanged:!1,newHistory:null}}),b(["print-env","printenv"],"Prints the names of the current environment variables.","print-env",e=>{if(e.length!==0)return v(g.get("print-env"));const n=Array.from(C);let t="";return n.forEach(r=>{t+=`${r[0]}, `}),t=t.substring(0,t.length-2),{result:!0,text:O(t),historyChanged:!1,newHistory:null}}),b(["print-var","printvar"],`Prints the values of the given environment variable. Functionally identical to '$ECHO ${W}var${z}'`,`print-var ${W}var${z}`,e=>e.length!==1?v(g.get("print-var")):(e[0]=e[0].replace("$",""),C.get(e[0])?{result:!0,text:O(te(e[0])),historyChanged:!1,newHistory:null}:{result:!1,text:`<span style='color: ${C.get("COLORS").get("error")}'>Error:</span> Unknown environment variable '${e[0]}'.
`,historyChanged:!1,newHistory:null})),b(["ls"],"Lists the given or current directory.",`ls ${W}path${z}`,e=>{let n="";if(e.length===0)n+=ne("");else if(e.length===1)n+=ne(e[0]);else return v(g.get("ls"));return{result:!0,text:n,historyChanged:!1,newHistory:null}}),b(["cd"],"Changes the working directory.",`cd ${W}path${z}`,e=>{let n;if(e.length===0)n=re("");else{if(e.length!==1)return v(g.get("cd"));n=re(e[0])}let t="";return n||(t=`<span style="color: ${C.get("COLORS").get("error")}">Error:</span> invalid path '${e[0]}'
`),{result:n,text:t,historyChanged:!1,newHistory:null}}),b(["pwd"],"Prints the working directory.","pwd",e=>e.length!==0?v(g.get("pwd")):{result:!0,text:`${V()}
`,historyChanged:!1,newHistory:null})]);function se(e,n,t){const r=e.replace("\\n"," <br> ").trim().split(" ");let o={result:!1,text:`<span style="color: ${C.get("COLORS").get("error")}">Error:</span> command not found: '${r[0]}'
`,historyChanged:!1,newHistory:null};return g.forEach(l=>{if(l.aliases.includes(r[0])){o=l.callback(r.slice(1,r.length),n,t);return}}),o}function v(e){return{result:!1,text:`<span style="color: ${C.get("COLORS").get("error")}">Error:</span> invalid args provided.
<span style="color: ${C.get("COLORS").get("heading1")}">Usage:</span> <span style="color: ${C.get("COLORS").get("command")}">[${e.usage.toString().replaceAll(",",", ")}]</span>
`,historyChanged:!1,newHistory:null}}function de(e){let n,t,r,o="github.com",l,s,a="cv@caveat.cc",x,f,c,d,m,P,y,H,E,M,T,_,F='<span class="terminal-cursor">▌</span>',N,q;return{c(){n=S("link"),t=R(),r=S("a"),r.textContent=o,l=R(),s=S("a"),s.textContent=a,x=R(),f=S("div"),c=S("input"),d=R(),m=S("p"),P=R(),y=S("div"),H=S("p"),E=Y(e[8]),M=Y(" ~>"),T=R(),_=S("p"),_.innerHTML=F,this.h()},l(u){n=L(u,"LINK",{href:!0,rel:!0,style:!0}),t=D(u),r=L(u,"A",{href:!0,rel:!0,target:!0,style:!0,"data-svelte-h":!0}),G(r)!=="svelte-ewq668"&&(r.textContent=o),l=D(u),s=L(u,"A",{href:!0,rel:!0,target:!0,style:!0,"data-svelte-h":!0}),G(s)!=="svelte-17wtamf"&&(s.textContent=a),x=D(u),f=L(u,"DIV",{class:!0});var h=j(f);c=L(h,"INPUT",{class:!0,id:!0,type:!0}),d=D(h),m=L(h,"P",{class:!0}),j(m).forEach(w),P=D(h),y=L(h,"DIV",{class:!0});var I=j(y);H=L(I,"P",{class:!0});var i=j(H);E=$(i,e[8]),M=$(i," ~>"),i.forEach(w),T=D(I),_=L(I,"P",{class:!0,"data-svelte-h":!0}),G(_)!=="svelte-53k1fx"&&(_.innerHTML=F),I.forEach(w),h.forEach(w),this.h()},h(){p(n,"href","https://indieauth.com/auth"),p(n,"rel","authorization_endpoint"),K(n,"visibility","hidden"),p(r,"href","https://github.com/caveat-dev"),p(r,"rel","me"),p(r,"target","_blank"),K(r,"visibility","hidden"),p(s,"href","mailto:cv@caveat.cc"),p(s,"rel","me"),p(s,"target","_blank"),K(s,"visibility","hidden"),p(c,"class","terminal-input"),p(c,"id","terminal-input"),p(c,"type","text"),p(m,"class","terminal-history"),p(H,"class","terminal-prompt"),p(_,"class","terminal-fake-input"),p(y,"class","terminal-fake-input-container"),p(f,"class","terminal-container")},m(u,h){k(u,n,h),k(u,t,h),k(u,r,h),k(u,l,h),k(u,s,h),k(u,x,h),k(u,f,h),A(f,c),e[12](c),ee(c,e[4]),A(f,d),A(f,m),e[16](m),A(f,P),A(f,y),A(y,H),A(H,E),A(H,M),A(y,T),A(y,_),e[17](_),e[18](f),N||(q=[Z(c,"input",e[13]),Z(c,"keydown",e[14]),Z(c,"keyup",e[15])],N=!0)},p(u,[h]){h&16&&c.value!==u[4]&&ee(c,u[4]),h&256&&fe(E,u[8])},i:X,o:X,d(u){u&&(w(n),w(t),w(r),w(l),w(s),w(x),w(f)),e[12](null),e[16](null),e[17](null),e[18](null),N=!1,oe(q)}}}function me(e,n,t){let r,o,l,s,a="",x=!1,f=!0,c=[],d=0,m="/";ae(()=>{o.focus(),P(),window.addEventListener("resize",P),setInterval(()=>{x?t(6,f=!0):t(6,f=!f)},1e3),setInterval(()=>{M(a,f)},1),H(se("welcome",a,s.innerHTML).text||""),ge(),t(8,m=V())});function P(){if(!r)return;let i=Math.min(window.innerHeight,window.innerWidth)*.95;t(0,r.style.width=i+"px",r),t(0,r.style.height=i+"px",r),y()}function y(){if(!r||!s)return;let i=0;for(;s.clientHeight+30>=r.clientHeight&&i<1e3;){const B=s.innerHTML.indexOf("<br>"),Q=s.innerHTML;t(3,s.innerHTML=Q.substring(B+4,Q.length),s),i++}}function H(i){s&&(t(3,s.innerHTML+=i,s),y())}function E(i,B=!0){t(3,s.innerHTML+=`<span class="terminal-prompt-history">${m} ~> </span>`,s),B?t(3,s.innerHTML+=`<span class="terminal-history-command-success"">${i}</span>`,s):t(3,s.innerHTML+=`<span class="terminal-history-command-failure"">${i}</span>`,s),t(3,s.innerHTML+="<br>",s)}function M(i,B){l&&(t(2,l.innerHTML=i,l),B&&t(2,l.innerHTML+='<span class="terminal-cursor">▌</span>',l))}function T(){if(a.trim()===""){E("");return}let i=se(a,a,s.innerHTML);E(a,i.result),H(i.text||""),i.result&&i.historyChanged&&t(3,s.innerHTML=i.newHistory||"",s),c.push(a),t(7,d=c.length),t(4,a=""),t(8,m=V())}function _(i){J[i?"unshift":"push"](()=>{o=i,t(1,o)})}function F(){a=this.value,t(4,a)}const N=i=>{(i.key==="ArrowLeft"||i.key==="ArrowRight")&&i.preventDefault(),t(5,x=!0)},q=i=>{i&&(i.key==="Enter"?(M("",f),T()):i.key==="Delete"?t(4,a=a.substring(0,a.length-1)):i.key==="ArrowUp"?(d>0&&t(7,d-=1),t(4,a=c[d]||"")):i.key==="ArrowDown"?(d<=c.length-1&&t(7,d+=1),t(4,a=c[d]||"")):t(4,a+=o.innerText),t(5,x=!1))};function u(i){J[i?"unshift":"push"](()=>{s=i,t(3,s)})}function h(i){J[i?"unshift":"push"](()=>{l=i,t(2,l)})}function I(i){J[i?"unshift":"push"](()=>{r=i,t(0,r)})}return[r,o,l,s,a,x,f,d,m,c,M,T,_,F,N,q,u,h,I]}class be extends ue{constructor(n){super(),ce(this,n,me,de,ie,{})}}export{be as component};
